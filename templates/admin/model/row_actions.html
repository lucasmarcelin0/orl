{% import 'admin/lib.html' as lib with context %}

{% macro _icon_svg(path_d) %}
<svg class="action-icon__svg" viewBox="0 0 24 24" role="img" aria-hidden="true" focusable="false">
    <path d="{{ path_d }}"></path>
</svg>
{% endmacro %}

{% macro _action_label(action, default_label) %}
{{ action.title or default_label }}
{% endmacro %}

{% macro link(action, url, icon_path, default_label) %}
{% set label = _action_label(action, default_label) %}
<a class="action-icon" href="{{ url }}" title="{{ label }}" aria-label="{{ label }}">
    {{ _icon_svg(icon_path) }}
</a>
{% endmacro %}

{% macro view_row(action, row_id, row) %}
  {{ link(action, get_url('.details_view', id=row_id, url=return_url), 'M12 5c-7.633 0-11 7-11 7s3.367 7 11 7 11-7 11-7-3.367-7-11-7zm0 11a4 4 0 110-8 4 4 0 010 8zm0-6a2 2 0 100 4 2 2 0 000-4z', _gettext('View Record')) }}
{% endmacro %}

{% macro view_row_popup(action, row_id, row) %}
  {% set icon = '<svg class="action-icon__svg" viewBox="0 0 24 24" role="img" aria-hidden="true" focusable="false"><path d="M12 5c-7.633 0-11 7-11 7s3.367 7 11 7 11-7 11-7-3.367-7-11-7zm0 11a4 4 0 110-8 4 4 0 010 8zm0-6a2 2 0 100 4 2 2 0 000-4z"></path></svg>' %}
  {{ lib.add_modal_button(url=get_url('.details_view', id=row_id, url=return_url, modal=True), title=_action_label(action, _gettext('View Record')), content=icon) }}
{% endmacro %}

{% macro edit_row(action, row_id, row) %}
  {{ link(action, get_url('.edit_view', id=row_id, url=return_url), 'M16.586 3.586a2 2 0 012.828 2.828l-9.9 9.9-3.768.5.5-3.768 9.9-9.9zm-2.829-1.414L4.707 11.222A2 2 0 004.16 12.3l-.64 4.82a1 1 0 001.12 1.12l4.82-.64a2 2 0 001.079-.547l9.05-9.05-5.732-5.732zM5 19h14v2H5v-2z', _gettext('Edit Record')) }}
{% endmacro %}

{% macro edit_row_popup(action, row_id, row) %}
  {% set icon = '<svg class="action-icon__svg" viewBox="0 0 24 24" role="img" aria-hidden="true" focusable="false"><path d="M16.586 3.586a2 2 0 012.828 2.828l-9.9 9.9-3.768.5.5-3.768 9.9-9.9zm-2.829-1.414L4.707 11.222A2 2 0 004.16 12.3l-.64 4.82a1 1 0 001.12 1.12l4.82-.64a2 2 0 001.079-.547l9.05-9.05-5.732-5.732zM5 19h14v2H5v-2z"></path></svg>' %}
  {{ lib.add_modal_button(url=get_url('.edit_view', id=row_id, url=return_url, modal=True), title=_action_label(action, _gettext('Edit Record')), content=icon) }}
{% endmacro %}

{% macro delete_row(action, row_id, row) %}
<form class="action-icon-form" method="POST" action="{{ get_url('.delete_view') }}">
  {{ delete_form.id(value=get_pk_value(row)) }}
  {{ delete_form.url(value=return_url) }}
  {% if delete_form.csrf_token is defined and delete_form.csrf_token %}
  {{ delete_form.csrf_token }}
  {% elif csrf_token is defined and csrf_token %}
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
  {% endif %}
  {% set label = _action_label(action, _gettext('Delete Record')) %}
  <button type="submit" class="action-icon__button" onclick="return faHelpers.safeConfirm('{{ _gettext('Are you sure you want to delete this record?') }}');" title="{{ label }}" aria-label="{{ label }}">
    {{ _icon_svg('M9 3a1 1 0 00-1 1v1H4v2h16V5h-4V4a1 1 0 00-1-1H9zm1 6v8h2V9h-2zm4 0v8h2V9h-2zM6 9v9a2 2 0 002 2h8a2 2 0 002-2V9H6z') }}
  </button>
</form>
{% endmacro %}
